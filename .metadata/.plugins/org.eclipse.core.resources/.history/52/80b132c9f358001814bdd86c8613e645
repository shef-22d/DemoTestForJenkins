/*
 * PEARSON PROPRIETARY AND CONFIDENTIAL INFORMATION SUBJECT TO NDA 
 * Copyright (c) 2017 Pearson Education, Inc.
 * All Rights Reserved. 
 * 
 * NOTICE: All information contained herein is, and remains the property of 
 * Pearson Education, Inc. The intellectual and technical concepts contained 
 * herein are proprietary to Pearson Education, Inc. and may be covered by U.S. 
 * and Foreign Patents, patent applications, and are protected by trade secret 
 * or copyright law. Dissemination of this information, reproduction of this  
 * material, and copying or distribution of this software is strictly forbidden   
 * unless prior written permission is obtained from Pearson Education, Inc.
 */
package com.glp.page;

import java.io.File;
import java.io.FileReader;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Scanner;
import java.util.Set;

import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.apache.log4j.Logger;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.safari.SafariDriver;

import com.autofusion.BaseClass;
import com.autofusion.ResourceConfigurations;
import com.autofusion.constants.Constants;
import com.autofusion.constants.KeywordConstant;
import com.autofusion.keywords.FindElement;
import com.autofusion.keywords.PerformAction;
import com.autofusion.util.FileDownloader;
import com.autofusion.util.FileUtil;
import com.relevantcodes.extentreports.ExtentTest;

public class GLPInstructor_InstructorDashboardPage extends BaseClass
        implements KeywordConstant {
    protected Logger APP_LOGS;
    protected ExtentTest reportTestObj;
    protected String result = "";
    protected String stepDescription = "";
    private PerformAction performAction = new PerformAction();

    public GLPInstructor_InstructorDashboardPage(ExtentTest reportTestObj,
            Logger APP_LOG) {
        this.APP_LOGS = APP_LOG;
        this.reportTestObj = reportTestObj;
    }

    /**
     * @author pallavi.tyagi
     * @date 10 April ,17
     * @description Click on Tab
     */
    public void clickOnElement(String element, String stepDesc) {
        this.performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, element);
        this.result = this.performAction.execute(ACTION_CLICK, element);
        logResultInReport(this.result, stepDesc, this.reportTestObj);
    }

    /**
     * @author tarun.gupta1
     * @date 12 July,2017
     * @description Verify element is present
     * @return The object of ProductApplication_WelcomeInstructorPage
     */
    public String verifyElementPresent(String locator, String message) {
        APP_LOG.debug("Element is present :" + locator);
        this.performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, locator);
        this.result = this.performAction.execute(ACTION_VERIFY_ELEMENT_PRESENT,
                locator);
        logResultInReport(this.result, message, this.reportTestObj);
        if (this.result.contains(Constants.PASS)) {
            return Constants.PASS;
        } else {
            return Constants.FAIL;
        }
    }

    /**
     * @author akshay.chimote
     * @date 19 May, 2017
     * @description To verify the CSS Value of an element
     */
    public String verifyElementCSSValue(String element, String cssName,
            String verifyText, String stepDesc) {
        Map<String, String> dataMap = new HashMap<String, String>();
        dataMap.put(ACTION_TO_PERFORM, ACTION_VERIFY_CSS_VALUE);
        dataMap.put(ELEMENT_LOCATOR, element);
        dataMap.put(COMPONENT_NAME, cssName);
        dataMap.put(ELEMENT_INPUT_VALUE, verifyText);
        this.result = this.performAction.execute(dataMap);
        logResultInReport(this.result, stepDesc, this.reportTestObj);
        return this.result;
    }

    /**
     * @author tarun.gupta1
     * @date 12 July,2017
     * @description Click on specific element
     * @return The object of ProductApplication_WelcomeInstructorPage
     */
    public GLPInstructor_ManagementDashboardPage switchToManagementTab() {
        performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE,
                "InstructorDashBoardManagementTab");
        APP_LOG.debug("Switch to Management Tab");
        clickOnElement("InstructorDashBoardManagementTab",
                "Switch to Management Tab");
        return new GLPInstructor_ManagementDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author tarun.gupta1
     * @date 12 July,2017
     * @description Click on specific element
     * @return The object of ProductApplication_WelcomeInstructorPage
     */
    public GLPInstructor_InstructorDashboardPage switchToPerformaceTab() {
        APP_LOG.debug("Switch to Performance Tab");
        clickOnElement("InstructorDashBoardPerformanceTab",
                "Switch to Performance Tab");
        return this;
    }

    /**
     * @author tarun.gupta1
     * @date 12 July,2017
     * @description Verify text message
     * @return The object of ProductApplication_WelcomeInstructorPage
     */
    public String verifyText(String element, String text, String stepDesc) {
        this.APP_LOG.debug("Verify text message " + text);
        this.performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, element);
        this.result = this.performAction.execute(ACTION_VERIFY_TEXT, element,
                text);
        if (result.contains("PASS")) {
            result = "PASS: " + element + " contains the correct text i.e. "
                    + text;
            logResultInReport(this.result, stepDesc, this.reportTestObj);
        } else {
            result = "FAIL: " + element
                    + " does not contains the correct text i.e. " + text;
            logResultInReport(this.result, stepDesc, this.reportTestObj);
        }
        return this.result;
    }

    public GLPInstructor_InstructorDashboardPage verifyElementAttributeValue(
            String element, String attributeName, String verifyText,
            String stepDesc) {
        Map<String, String> dataMap = new HashMap<String, String>();
        dataMap.put(ACTION_TO_PERFORM, ACTION_VERIFY_ATTRIBUTE_VALUE);
        dataMap.put(ELEMENT_LOCATOR, element);
        dataMap.put(COMPONENT_NAME, attributeName);
        dataMap.put(ELEMENT_INPUT_VALUE, verifyText);
        this.result = this.performAction.execute(dataMap);
        logResultInReport(this.result, stepDesc, this.reportTestObj);
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author Pallavi.Tyagi
     * @date 3 Oct,2017
     * @description Verify page title of performance dashboard
     * @return The object of ProductApplication_CourseHomePage
     */

    public GLPInstructor_InstructorDashboardPage
           verifyPerformanceDashboardTitle(String exptectedTitle,
                   String description) {
        this.result = this.performAction.execute(ACTION_VERIFY_TITLE,
                exptectedTitle);
        logResultInReport(this.result, description, this.reportTestObj);
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author pallavi.tyagi
     * @date 3 Oct,2017
     * @description Verify element is present
     * @return The object of ProductApplication_courseHomePage
     */
    public String getText(String locator) {
        APP_LOG.debug("Element is present: " + locator);
        this.performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, locator);
        String valueText = this.performAction.execute(ACTION_GET_TEXT, locator);
        return valueText;
    }

    /**
     * @author Pallavi.tyagi
     * @date 3 Oct,2017
     * @description Verify Completion percentage is displayed or not.
     * @return The object of ProductApplication_PerformanceDashboardPage.
     */
    public GLPInstructor_InstructorDashboardPage verifyCompletionPercentage() {

        String completionText = getText("PerformanceDashboardCompletionValue");
        if (completionText.equalsIgnoreCase("")) {

            this.result = Constants.FAIL
                    + ": Completion percentage is not displayed in completion card";
            logResultInReport(this.result,
                    "Completion percentage is not displayed in completion card",
                    this.reportTestObj);
        } else {
            this.result = Constants.PASS
                    + ": Completion percentage is displayed in completion card";
            logResultInReport(this.result,
                    "Completion percentage is displayed in completion card",
                    this.reportTestObj);

        }

        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author nisha.pathria
     * @date 4 oct 2017
     * @description :Verify element not present.
     */
    public GLPInstructor_InstructorDashboardPage
           verifyElementNotPresent(String locator, String message) {
        try {
            APP_LOG.debug(locator + "Element is not present");
            // Adding wait for synchronization
            Thread.sleep(2000);
            this.result = this.performAction
                    .execute(ACTION_VERIFY_ELEMENT_NOT_PRESENT, locator);
            logResultInReport(this.result, message, this.reportTestObj);
        } catch (Exception e) {
            APP_LOG.debug(
                    "Exception occurred while verifying element's non-existence");
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    public GLPInstructor_InstructorDashboardPage
           verifySectionValue(String section, String element) {
        String numberOfStudent = getText(element);
        if (numberOfStudent.matches("[0-9]+") && numberOfStudent.length() > 0) {
            this.result = Constants.PASS + ": Total " + section
                    + "section values are present";
            logResultInReport(this.result,
                    "Total " + section + "section values are present",
                    this.reportTestObj);
        } else {
            this.result = Constants.FAIL + ": Total " + section
                    + "section values are not present";
            logResultInReport(this.result,
                    "Total " + section + "section values are not present",
                    this.reportTestObj);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    public GLPInstructor_InstructorDashboardPage clickOnFirstModuleTime() {
        FindElement element = new FindElement();
        List<WebElement> timeOnTask = element
                .getElements("InstructorDashBoardModuleTime");
        timeOnTask.get(0).click();
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    public GLPInstructor_InstructorDashboardPage verifyTimeBarsForALLLO() {
        FindElement element = new FindElement();
        try {

            List<WebElement> allTimeOnTask = element
                    .getElements("InstructorDashBoardModuleTime");
            int verticleCoordinates = 300;
            for (int i = 0; i < allTimeOnTask.size(); i++) {
                allTimeOnTask.get(i).click();
                verifyElementPresent(
                        "InstructorDashBoardChartColorBarPlacedOut",
                        "Verify placed out bar is present for Module "
                                + (i + 1));
                verifyElementPresent(
                        "InstructorDashBoardChartColorBarCompleted",
                        "Verify completed bar is present for Module "
                                + (i + 1));
                verifyElementPresent(
                        "InstructorDashBoardChartColorBarInProgress",
                        "Verify in progress bar is present for Module "
                                + (i + 1));
                verifyElementPresent(
                        "InstructorDashBoardChartColorBarNotStarted",
                        "Verify not started bar is present for Module "
                                + (i + 1));

                clickOnElement("InstructorDashBoardChartCollapseButton",
                        "Click on the collapse icon on the performance dashboard for Module "
                                + (i + 1));

                objCommonUtil.scrollWebPage(0, verticleCoordinates);
                verticleCoordinates = verticleCoordinates + 100;
            }
        } catch (Exception e) {
            APP_LOG.debug(
                    "Exception comes in ProductApplication_InstructorDashboardPage method"
                            + e);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    public GLPInstructor_InstructorDashboardPage
           verifyTimeWithClockForEachLO() {
        FindElement element = new FindElement();
        try {
            List<WebElement> timeTextOnTask = element
                    .getElements("InstructorDashBoardModuleClockIcon");
            List<WebElement> timerIconOnTask = element
                    .getElements("InstructorDashBoardModuleTime");
            if (timeTextOnTask.size() != timerIconOnTask.size()) {
                this.result = Constants.FAIL
                        + ": total time fields doesnot match with clock icon";
                logResultInReport(this.result,
                        "total time fields doesnot match with clock icon",
                        this.reportTestObj);
            } else {
                for (int i = 0; i < timeTextOnTask.size(); i++) {
                    if (timeTextOnTask.get(i).isDisplayed()
                            && timerIconOnTask.get(i).isDisplayed()) {
                        this.result = Constants.PASS
                                + ": time and timer icon both are present for Module "
                                + (i + 1);
                        logResultInReport(this.result,
                                "time and timer icon both are present for Module "
                                        + (i + 1),
                                this.reportTestObj);
                    } else {
                        this.result = Constants.FAIL
                                + ": time and timer icon  are not present for Module "
                                + (i + 1);
                        logResultInReport(this.result,
                                "time and timer icon both are not present for Module "
                                        + (i + 1),
                                this.reportTestObj);
                    }
                }

            }

        } catch (Exception e) {
            APP_LOG.debug(
                    "Exception comes in verifyTimeWithClockForEachLO method"
                            + e);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);

    }

    public GLPInstructor_InstructorDashboardPage
           verifyCompletionRateWithTickIconForEachLO() {
        FindElement element = new FindElement();
        try {
            List<WebElement> completionPercent = element
                    .getElements("InstructorDashBoardModuleCompletionPercent");
            List<WebElement> tickIcon = element
                    .getElements("InstructorDashBoardTickIcon");
            if (completionPercent.size() != tickIcon.size()) {
                this.result = Constants.FAIL
                        + ": total Completion percent doesnot match with Tick icon";
                logResultInReport(this.result,
                        "total Completion percent doesnot match with Tick icon",
                        this.reportTestObj);
            } else {
                for (int i = 0; i < completionPercent.size(); i++) {
                    if (completionPercent.get(i).isDisplayed()
                            && tickIcon.get(i).isDisplayed()) {
                        this.result = Constants.PASS
                                + ": completion percent and tick icon both are present for Module "
                                + (i + 1);
                        logResultInReport(this.result,
                                "Completion percent and tick icon both are present for Module "
                                        + (i + 1),
                                this.reportTestObj);
                    } else {
                        this.result = Constants.FAIL
                                + ": completion percent and tick icon both are not present for Module "
                                + (i + 1);
                        logResultInReport(this.result,
                                "Completion percent and tick icon both are not present for Module "
                                        + (i + 1),
                                this.reportTestObj);
                    }
                }

            }

        } catch (Exception e) {
            APP_LOG.debug(
                    "Exception comes in verifyCompletionRateWithTickIconForEachLO method"
                            + e);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);

    }

    public GLPInstructor_InstructorDashboardPage
           verifyTickIconForEachModuleClickable() {
        FindElement element = new FindElement();
        try {

            List<WebElement> tickPercent = element
                    .getElements("InstructorDashBoardTickIcon");
            int verticleCoordinates = 300;
            for (WebElement tick : tickPercent) {
                tick.click();
                verifyElementPresent(
                        "InstructorDashBoardChartColorBarPlacedOut",
                        "Verify placed out bar is present");
                clickOnElement("InstructorDashBoardChartCollapseButton",
                        "Click on the collapse icon on the performance dashboard");

                objCommonUtil.scrollWebPage(0, verticleCoordinates);
                verticleCoordinates = verticleCoordinates + 100;
            }
        } catch (Exception e) {
            APP_LOG.debug(
                    "Exception comes in verifyTickIconForEachModuleClickable method"
                            + e);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    public GLPInstructor_InstructorDashboardPage
           verifyCompletionTitleForModule() {
        FindElement element = new FindElement();
        try {

            List<WebElement> tickPercent = element
                    .getElements("InstructorDashBoardTickIcon");
            tickPercent.get(0).click();
            verifyText("InstructorDashBoardCompletionTitleName", "Completion",
                    "Verify Completion title is present");
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    public GLPInstructor_InstructorDashboardPage
           verify4BoxesUnderCompletionTitle() {
        FindElement element = new FindElement();
        try {

            List<WebElement> tickPercent = element
                    .getElements("InstructorDashBoardTickIcon");
            tickPercent.get(0).click();
            verifyText("InstructorDashBoardCompletionTitleName", "Completion",
                    "Verify Completion title is present");
            verifyElementPresent("InstructorDashBoardChartColorBarPlacedOut",
                    "Verify placed out bar is present");
            verifyElementPresent("InstructorDashBoardChartColorBarCompleted",
                    "Verify completed bar is present");
            verifyElementPresent("InstructorDashBoardChartColorBarInProgress",
                    "Verify in progress bar is present");
            verifyElementPresent("InstructorDashBoardChartColorBarNotStarted",
                    "Verify not started bar is present");

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * @date 1 Nov 2017
     * @description :Verify 1. Completion card should be opened with
     *              "Completion" title in pre-assessment section 2. Observe
     *              (A)Completion, Assessment and Placement Results test should
     *              be displayed in bold. (B)Placement Results text font size
     *              should be equal to Completion text font size. (C)Horizontal
     *              bar edges should be round.
     */
    public GLPInstructor_InstructorDashboardPage
           verifyPreAssessmentCompletionCardOnUI() {
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");
            verifyElementPresent("CompletionTextBold",
                    "Verify Completion card is opened with title 'Completion' in Pre-Assesment section.");
            verifyElementCSSValue("CompletionTextBold", "font-weight",
                    ResourceConfigurations.getProperty("fontWeight"),
                    "Verify 'Completion' Text is displayed as bold.");
            verifyElementCSSValue("AssessmentTextBold", "font-weight",
                    ResourceConfigurations.getProperty("fontWeight"),
                    "Verify 'Pre-Assessment' Text is displayed as bold.");
            verifyElementCSSValue("PlacementResultsTextBold", "font-weight",
                    ResourceConfigurations.getProperty("fontWeight"),
                    "Verify 'Placement' Text is displayed as bold.");

            compareFontSize(); // Compare font size of Completion and Placement
            // results texts.

            verifyElementCSSValue("HorizontalBar", "border-radius",
                    ResourceConfigurations.getProperty("borderRadius"),
                    "Verify Horizontal bar edges are round.");

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * @date 1 Nov 2017
     * @description :Verify Completion card should be opened, where Completed,
     *              in progress and not started blocks should be displayed below
     *              the completion text.
     */
    public GLPInstructor_InstructorDashboardPage verifyStatusBlocks() {
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");

            verifyElementPresent("CompletedBlock",
                    "Verify Completed block is displayed.");

            verifyElementPresent("InProgressBlock",
                    "Verify InProgress block is displayed.");

            verifyElementPresent("NotStartedBlock",
                    "Verify Not started block is displayed");

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * @date 1 Nov 2017
     * @description :Completion card should be opened,where colour of all
     *              categories:completed, in progress and not started should be
     *              different.
     */
    public GLPInstructor_InstructorDashboardPage verifyColorOfStatusBlocks() {
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");
            String completedColor = verifyElementCSSValue("CompletedBlock",
                    "background-color",
                    ResourceConfigurations.getProperty("completedBlockColor"),
                    "Verify Completed block color is different.");
            String inProgressColor = verifyElementCSSValue("InProgressBlock",
                    "background-color",
                    ResourceConfigurations.getProperty("inProgressBlockColor"),
                    "Verify InProgress block color is different.");
            String notStartedColor = verifyElementCSSValue("NotStartedBlock",
                    "background-color",
                    ResourceConfigurations.getProperty("notStartedBlockColor"),
                    "Verify Not started block color is different.");
            if (completedColor.equals(inProgressColor)) {
                result = inProgressColor;
                logResultInReport(result,
                        "Verify colour of all categories:completed, in progress and not started should be different.",
                        this.reportTestObj);
            } else {
                result = inProgressColor;
                logResultInReport(result,
                        "Verify colour of all categories:completed, in progress and not started should be different.",
                        this.reportTestObj);
            }

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * @date 2 Nov 2017
     * @description :Verify Completion card should be opened,where placement
     *              results is displayed below the bars with following content:
     *              (a)Number of student should be displayed in circular image.
     *              (b)Module number and module name should be displayed below
     *              the circle. (c)Circle should be filled with no colour if
     *              number of Student is zero.
     */
    public GLPInstructor_InstructorDashboardPage
           verifyCompletionCardForPlacementResults() {
        FindElement element = new FindElement();
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");
            List<WebElement> studentNumber = element
                    .getElements("StudentNumber");
            for (WebElement we : studentNumber) {
                if (!we.getCssValue("border-radius")
                        .equals(ResourceConfigurations
                                .getProperty("borderRadiusCircle")))
                    ;
                {
                    this.result = Constants.FAIL
                            + ": Number of student should not be displayed in circular image.";
                    logResultInReport(this.result,
                            "Number of student should not be displayed in circular image.",
                            this.reportTestObj);
                }

            }

            List<WebElement> moduleNumber = element.getElements("ModuleNumber");
            for (WebElement we : moduleNumber) {
                if (!we.getText().contains("Module")) {
                    this.result = Constants.FAIL
                            + ": Module number should not be displayed below the circle";
                    logResultInReport(this.result,
                            "Module number should not be displayed below the circle",
                            this.reportTestObj);
                }

            }
            List<WebElement> moduleName = element.getElements("ModuleName");
            for (WebElement we : moduleName) {
                if (we.getText().contains(" ")) {
                    this.result = Constants.FAIL
                            + ": Module name should not be displayed below the circle";
                    logResultInReport(this.result,
                            "Module name should not be displayed below the circle",
                            this.reportTestObj);
                }

            }
            List<WebElement> circleWithNoColor = element
                    .getElements("CircleWithNoColor");
            for (WebElement we : circleWithNoColor) {
                if (we.getCssValue("border-radius")
                        .equals(ResourceConfigurations
                                .getProperty("borderRadiusCircle")))
                    ;
                {
                    this.result = Constants.FAIL
                            + ": Circle should not be filled with no colour if number of Student is zero.";
                    logResultInReport(this.result,
                            "Circle should not be filled with no colour if number of Student is zero.",
                            this.reportTestObj);
                }

            }

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * @date 2 Nov 2017
     * @description :Verify that Completion card should be collapsed by clicking
     *              arrow at the bottom of the card.
     */
    public GLPInstructor_InstructorDashboardPage
           verifyCompletionCardCollapsed() {
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");
            verifyElementPresent("CompletionCard",
                    "Verify Completion card should be collapsed by clicking arrow at the bottom of the card.");

            clickOnElement("CompletionCard", "Click on Completion card");
            verifyElementNotPresent("CompletionCard",
                    "Verify Completion card should be collapsed by clicking arrow at the bottom of the card.");
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * 
     * @date 3 Nov 2017
     * @description :verify that on clicking Time on task tab Time on task card
     *              should be opened.
     */
    public GLPInstructor_InstructorDashboardPage verifyTimeOnTaskCardOpened() {
        try {

            clickOnElement("InstructorDashBoardTimeOnTaskTab",
                    "Click on pre-assessment 'Time-on-Task' tab.");
            verifyElementPresent("InstructorDashBoardPreAssessmentChartSummary",
                    "Verify Time on task card should be opened.");
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author sumit.bhardwaj
     * @date Jan 29, 2018
     * @description Check if Gradebook downloaded or not.
     */
    public GLPInstructor_InstructorDashboardPage verifyScoreInGradeBook(
            String userName, String password, String diagnosticTestScore,
            String overallDiagnosticScore) {

        FindElement ele = new FindElement();
        ele.checkPageIsReady();
        FileDownloader fileDown = new FileDownloader();
        String destinationFolder = fileDown.downloader(userName, password);
        APP_LOG.info("Folder location: " + destinationFolder);
        if (destinationFolder != null) {
            Scanner inputStream = null;
            try {
                File folder = new File(destinationFolder);
                File[] files = folder.listFiles();
                String fileName = files[0].getName();
                String gradeBookTestScore = null;
                String gradeBookOverallScore = null;
                try {
                    FileReader reader;
                    if (System.getProperty("os.name").contains("Mac") || System
                            .getProperty("os.name").contains("Linux")) {
                        reader = new FileReader(
                                destinationFolder + "//" + fileName);
                    } else {
                        reader = new FileReader(
                                destinationFolder + "\\" + fileName);
                    }
                    APP_LOG.info("File location: " + reader);
                    CSVParser csvParser = new CSVParser(reader,
                            CSVFormat.DEFAULT.withFirstRecordAsHeader()
                                    .withIgnoreHeaderCase().withTrim());
                    for (CSVRecord csvRecord : csvParser) {
                        // Accessing Values by Column Index
                        gradeBookTestScore = csvRecord
                                .get("Course Diagnostic Correct Score");
                        gradeBookOverallScore = csvRecord
                                .get("Course Diagnostic Possible Score");
                        APP_LOG.info(
                                "Record No - " + csvRecord.getRecordNumber());
                        APP_LOG.info(
                                "gradeBookTestScore : " + gradeBookTestScore);
                        APP_LOG.info("gradeBookOverallScore : "
                                + gradeBookOverallScore);
                    }
                } catch (Exception e) {
                    APP_LOG.error(
                            "Exception occured while reading gradebook" + e);
                }
                if (diagnosticTestScore.contains(".")) {
                    while (diagnosticTestScore.endsWith("0")
                            && diagnosticTestScore.contains(".")) {
                        diagnosticTestScore = diagnosticTestScore.substring(0,
                                diagnosticTestScore.length() - 1);
                        if (diagnosticTestScore.endsWith(".")) {
                            diagnosticTestScore = diagnosticTestScore.substring(
                                    0, diagnosticTestScore.length() - 1);
                        }
                    }
                }
                if (gradeBookTestScore == null) {
                    result = Constants.FAIL
                            + ": Diagnostic Test Score is not available in Gradebook.";
                    logResultInReport(this.result,
                            "Verify Diagnostic test score in user gradebook.",
                            this.reportTestObj);
                } else {
                    if (diagnosticTestScore.equals(gradeBookTestScore)
                            && (overallDiagnosticScore
                                    .equals(gradeBookOverallScore))) {
                        result = Constants.PASS + ": Diagnostic Test Score '"
                                + diagnosticTestScore + "/"
                                + overallDiagnosticScore
                                + "' is matching with corresponding diagnostic Score '"
                                + gradeBookTestScore + "/"
                                + gradeBookOverallScore + "' in Gradebook.";
                        logResultInReport(this.result,
                                "Verify Diagnostic test score in user gradebook.",
                                this.reportTestObj);
                    } else {
                        result = Constants.FAIL + ": Diagnostic Test Score '"
                                + diagnosticTestScore + "/"
                                + overallDiagnosticScore
                                + "' is not matching with corresponding diagnostic Score '"
                                + gradeBookTestScore + "/"
                                + gradeBookOverallScore + "' in Gradebook.";
                        logResultInReport(this.result,
                                "Verify Diagnostic test score in user gradebook.",
                                this.reportTestObj);
                    }
                }
                // f.deleteFolder(destinationFolder);

            } catch (Exception e) {
                APP_LOG.error(e.getMessage());
                result = Constants.FAIL
                        + ": Unexpected error while reading Gradebook: "
                        + e.getMessage();
                logResultInReport(this.result,
                        "Verify Diagnostic test score in user gradebook.",
                        this.reportTestObj);

            } finally {
                // f.deleteFolder(destinationFolder);
                try {
                    inputStream.close();
                } catch (Exception e) {

                    APP_LOG.info("Error while closing input steram:" + e);
                }

            }

        } else

        {
            logResultInReport(
                    Constants.FAIL + ": Error while downloading Gradebook",
                    "Verify gradebook downloaded.", reportTestObj);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * 
     * @date 3 Nov 2017
     * @description :Time on task card should be opened with following content
     *              (a)Average time taken by class should be displayed (b)After
     *              Average time, watch icon is displayed.
     */
    public GLPInstructor_InstructorDashboardPage

           verifyTimeOnTaskCardAverageTime() {
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * 
     * @date 3 Nov 2017
     * @description :Time on task card should be opened where 4 Boxes should be
     *              displayed showing time range for different categories i.e <
     *              30 min, 30-45 min, 45-60 min, > 60 min
     */
    public GLPInstructor_InstructorDashboardPage verify4BoxesOnTimeONTask() {
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * @date 3 Nov 2017
     * @description :Time on task card should be opened where colour of all
     *              categories:< 30 min, 30-45 min, 45-60 min, > 60 min should
     *              be different.
     */
    public GLPInstructor_InstructorDashboardPage verifyColourOfAllCategory() {
        try {

            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author rashmi.z
     * 
     * @date 3 Nov 2017
     * @description :Time on task card should be collapsed .
     */
    public GLPInstructor_InstructorDashboardPage verifyTimeCardCollapsed() {
        try {
            clickOnElement("InstructorPreAssessmentCompletionTitleName",
                    "Click on pre-assessment node of graph/Click on pre-assessment completion tab.");

        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author nitish.jaiswal
     * 
     * @date 13 Nov 2017
     * @description :compare font size
     */
    public void compareFontSize() {

        try {
            String completionFontSize = verifyElementCSSValue(
                    "CompletionTextBold", "font-size",
                    ResourceConfigurations.getProperty("fontSize"),
                    "Verify 'Completion' Text font-size.");
            String placementFontSize = verifyElementCSSValue(
                    "PlacementResultsTextBold", "font-size",
                    ResourceConfigurations.getProperty("fontSize"),
                    "Verify 'Placement' Text font-size.");
            if (completionFontSize.equals(placementFontSize)) {
                result = placementFontSize;
                logResultInReport(result,
                        "Verify Placement Results text font size is equal to Completion text font size.",
                        this.reportTestObj);
            }
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
    }

    /**
     * @author mukul.sehra
     * @param webElementLocator
     *            --> element to scroll into
     */
    public void scrollIntoView(String webElementLocator) {
        this.performAction.execute(ACTION_SCROLL_INTO_VIEW, webElementLocator);
    }

    /**
     * @author mohit.gupta5
     * @date 08 Dec,2017
     * @description Check if element is a link.
     * @return The object of ProductApplication_CourseViewPage
     */
    public GLPInstructor_InstructorDashboardPage
           verifyFooterHyperLinks(String locator, String desc) {
        FindElement element = new FindElement();
        WebElement menuOptions = element.getElement(locator);
        String value = menuOptions.getAttribute("href");
        if (value.startsWith("https")) {
            result = Constants.PASS + ": Verify '" + locator + "' is a link.";
            logResultInReport(this.result, desc, this.reportTestObj);
        } else {
            result = Constants.FAIL + ": '" + locator + "' is not a link.";
            logResultInReport(this.result, desc, this.reportTestObj);
        }

        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author mohit.gupta5
     * @date Dec 07, 2017
     * @description Check if footer elements are link.
     */
    public GLPInstructor_InstructorDashboardPage verifyFooterHyperLinks() {
        // Verify 'Copyright Â©2017 Pearson Education Inc. All rights
        // reserved.'Text is present
        verifyText("DashBoardFooterCopyRightText",
                ResourceConfigurations.getProperty("copyRightLinkText"),
                "Verify 'Copyright 2017 Pearson Education Inc. All rights reserved' Text is present.");

        // Verify 'Accessibilty' is a link
        verifyFooterHyperLinks("DashBoardFooterAccessibilityLink",
                "Verify 'Accessibilty' is a link");
        // Verify 'Accessibilty' link text is present
        verifyText("DashBoardFooterAccessibilityLink",
                ResourceConfigurations.getProperty("accessibilityText"),
                "Verify 'Accessibilty' link text is present");

        // Verify 'Privacy Policy' is a link
        verifyFooterHyperLinks("DashBoardPrivacyPolicyLink",
                "Verify 'Privacy Policy' is a link");
        // Verify 'Privacy Policy' link text is present
        verifyText("DashBoardPrivacyPolicyLink",
                ResourceConfigurations.getProperty("privacyPolicyText"),
                "Verify 'Privacy Policy' link text is present");

        // Verify 'Terms & Conditions' is a link
        verifyFooterHyperLinks("DashBoardFooterTermsAndConditionsLink",
                "Verify 'Terms & Conditions' is a link");
        // Verify 'Terms & Conditions' link text is present
        verifyText("DashBoardFooterTermsAndConditionsLink",
                ResourceConfigurations.getProperty("termsConditionsText"),
                "Verify 'Terms & Conditions' link text is present");
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author sumit.bhardwaj
     * @date Jan 29, 2018
     * @description Check if Gradebook downloaded or not.
     */
    public GLPInstructor_InstructorDashboardPage verifyGradeBookDownloaded(
            String userName, String password, String desc) {
        FileDownloader fileDown = new FileDownloader();
        String destinationFolder = fileDown.downloader(userName, password);
        if (destinationFolder != null) {
            logResultInReport(
                    Constants.PASS + ": Gradebook downloaded successfully",
                    desc, reportTestObj);
            FileUtil f = new FileUtil();
            f.deleteFolder(destinationFolder);
        } else {
            logResultInReport(
                    Constants.FAIL + ": Error while downloading Gradebook",
                    desc, reportTestObj);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);

    }

    /**
     * @author nisha.pathria
     * @date 14 Nov,2017
     * @description Accessibility link open in new tab.
     * @return The object of ProductApplication_InstructorDashboardPage
     */
    public GLPInstructor_CourseViewPage verifyFooterLinksOpenInNewTab() {

        APP_LOG.debug("Footer link open in new tab.");
        verifyLinkOpenInNewTab("DashBoardFooterAccessibilityLink",
                ResourceConfigurations.getProperty(
                        "accessibilityInformationRevelPearsonText"),
                "Verify Accessibility link open in new tab.");
        verifyLinkOpenInNewTab("DashBoardPrivacyPolicyLink",
                ResourceConfigurations.getProperty("pearsonPrivacyPolicyText"),
                "Verify Privacy Policy link open in new tab.");
        verifyLinkOpenInNewTab("DashBoardFooterTermsAndConditionsLink",
                ResourceConfigurations.getProperty("pearsonTermsOfUseText"),
                "Verify Terms and Conditions link open in new tab.");

        return new GLPInstructor_CourseViewPage(reportTestObj, APP_LOG);
    }

    /**
     * @author nisha.pathria
     * @date 14 Nov,2017
     * @description Accessibility link open in new tab.
     * @return The object of ProductApplication_InstructorDashboardPage
     */
    public GLPInstructor_CourseViewPage verifyLinkOpenInNewTab(String locator,
            String expectedTitle, String message) {

        APP_LOG.debug("VerifyLinkOpenInNewTab for Instructor");
        try {
            // Getting the current window handle
            String parentWindow = returnDriver().getWindowHandle();
            ArrayList<String> windows = new ArrayList<String>();
            int i = 0;

            // Adding current window to the 0th index in a list
            windows.add(i, parentWindow);
            clickOnElement(locator,
                    "Click on '" + locator + "' link in footer.");
            APP_LOG.info(locator + " is clicked.");

            // Using sleep to wait for the new window to load
            Thread.sleep(10000);

            // Getting all the window handles after the footer link has been
            // clicked
            Set<String> uniqueWindow = returnDriver().getWindowHandles();

            // Adding the window handles other than the parent window in the
            // list from 1st index
            for (String iterator : uniqueWindow) {
                if (!iterator.equals(parentWindow)) {
                    windows.add(++i, iterator);
                }
            }

            // Getting the window handle string of the last window in the list
            String footerLinkNewWindow = windows.get(windows.size() - 1);

            // Assert that more than one windows are opened currently and the
            // window the application switched to has the same title as expected
            if (windows.size() > 1) {
                returnDriver().switchTo().window(footerLinkNewWindow);
                if (returnDriver().getTitle().equals(expectedTitle)) {
                    this.result = Constants.PASS
                            + ": Correct window has opened, since actual page title '"
                            + returnDriver().getTitle()
                            + "' and expected page title '" + expectedTitle
                            + "' are same.";
                    logResultInReport(this.result, message, this.reportTestObj);
                    // Closing the footerLink window
                    returnDriver().close();
                    // Switch to the parent Window
                    returnDriver().switchTo().window(parentWindow);
                }
            } else {
                this.result = Constants.FAIL
                        + ": Footer link window doesn't opened in new tab";
                logResultInReport(this.result, message, this.reportTestObj);
            }

        } catch (Exception t) {
            APP_LOG.error(t.getMessage());
            this.result = Constants.FAIL
                    + ": Exception while switching to window : "
                    + t.getMessage();
            logResultInReport(this.result, message, this.reportTestObj);
        }
        return new GLPInstructor_CourseViewPage(reportTestObj, APP_LOG);
    }

    /**
     * @author Mayank.MIttal
     * @date 13 Mar,2018
     * @description Verify All Elements Value In List with Keyword when 'Select'
     *              tag is present
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public GLPInstructor_InstructorDashboardPage getAllElementsInList(
            String stepDesc, String element, String listExpectedValues) {

        this.APP_LOGS.debug(stepDesc);
        String str = this.performAction.execute(ACTION_SELECT_ALLVALUESFROMLIST,
                element);
        System.out.println(str);
        logResultInReport(this.result, stepDesc, this.reportTestObj);
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);

    }

    /**
     * @author Mayank.MIttal
     * @date 13 Mar,2018
     * @description Verify All Elements Value In List
     * @return The object of GLPInstructor_InstructorDashboardPage
     */

    public GLPInstructor_InstructorDashboardPage
           verifyAllElementsValueInList(String elementID, String value) {
        String allValuesinDropDown = "";
        FindElement element = new FindElement();
        List<WebElement> listValues = element.getElements(elementID);
        System.out.println(listValues);
        for (WebElement webElement : listValues) {
            String s = webElement.getText();
            allValuesinDropDown = allValuesinDropDown + s + " ";
        }
        String ActualResult = allValuesinDropDown;
        System.out.println(ActualResult);
        String ExpectedValue = ResourceConfigurations.getProperty(value);
        if (ActualResult.trim().equals(ExpectedValue.trim())) {
            logResultInReport(Constants.PASS,
                    "Verify Drop Down contains all expected values.",
                    this.reportTestObj);
        } else {
            logResultInReport(Constants.FAIL,
                    "Verify Drop Down does not contains all expected values.",
                    this.reportTestObj);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author Mayank.MIttal
     * @date 13 Mar,2018
     * @description select a value from list
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public GLPInstructor_InstructorDashboardPage
           selectAValueFromList(String inputValue, String elementID) {
        FindElement element = new FindElement();
        List<WebElement> listValues = element.getElements(elementID);
        for (WebElement option : listValues) {
            if (inputValue.equals(option.getText()))
                option.click();
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author Mayank.MIttal
     * @date 13 Mar,2018
     * @description List count for Student list (Total rows)
     * @return listCount
     */
    public int getListCount(String elementID) {
        FindElement element = new FindElement();
        List<WebElement> listValues = element.getElements(elementID);
        int listCount = listValues.size();
        return listCount;
    }

    /**
     * @author Mayank.MIttal
     * @date 13 Mar,2018
     * @description Verify Logout
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public GLPInstructor_InstructorDashboardPage verifyLogout() {
        try {
            clickOnElement("CourseViewUserName",
                    "Click on User name to open Signout DropDown.");
            if (webDriver instanceof SafariDriver
                    || capBrowserName.equalsIgnoreCase("Safari")) {
                ((JavascriptExecutor) returnDriver()).executeScript(
                        "arguments[0].click();", webDriver.findElement(
                                By.cssSelector("a[class*='sign-out-button']")));
            } else {
                clickOnElement("LogoutButton", "Click on Logout Button.");
            }
            GLPConsole_LoginPage objLoginPage = new GLPConsole_LoginPage(
                    reportTestObj, APP_LOGS);
            objLoginPage.verifyElementPresent("ConsoleLoginUserName",
                    "Verify user has successfully logged out.");
        } catch (Exception t) {
            APP_LOG.error(t.getMessage());
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOGS);
    }

    public String verifyWebtableValuesOnFilterSelection(String locator1,
            String locator2) {

        String result1 = verifyElementPresent(locator1,
                "No result is found as per the filter.");
        String result2 = verifyElementPresent(locator2,
                "Record is present as per the filter.");
        if (result1.equalsIgnoreCase("Constants.PASS")
                || result2.equalsIgnoreCase("Constants.PASS")) {
            return Constants.PASS;
        } else {
            return Constants.FAIL;
        }
    }

    /**
     * @author nitish.jaiswal
     * @date 20 Mar,2018
     * @description handle popup for unlock if exists
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public GLPInstructor_InstructorDashboardPage
           handleUnlockPopupIfExists(String locator) {
        APP_LOG.debug("Handle unlock popup");
        if (this.performAction
                .execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, locator)
                .contains(Constants.PASS)) {
            clickOnElement(locator, "Click on 'Unlock Now' button if exists.");
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOGS);
    }

    /**
     * @author pankaj.sarjal
     * @date 21 Mar,2018
     * @description Switch to 'Student List' tab
     * @return
     */
    public GLPInstructor_InstructorDashboardPage switchToStudentListTab() {
        APP_LOG.debug("Switch to Student List Tab");
        clickOnElement("InstructorDashBoardPerformanceStudentList",
                "Switch to Student List Tab");
        return this;
    }

    /**
     * @author pankaj.sarjal
     * @param argsList
     * @description : Press 'Escape' key and verify 'Welcome back' message
     *              pop-up disappear
     * @return
     */

    public void pressEscapeAndVerifyWelcomeBackPopUp() {
        APP_LOG.debug("Func:pressEscapeKey");

        try {
            Actions action = new Actions(returnDriver());
            action.sendKeys(Keys.ESCAPE).perform();
            if (performAction
                    .execute(ACTION_VERIFY_ELEMENT_NOT_PRESENT,
                            "InstructorDashBoardUnlockPopup")
                    .contains(Constants.PASS)) {
                result = Constants.PASS
                        + ": 'Welcome back' popup disappear from UI after pressing Escape key.";
                logResultInReport(this.result,
                        "Verify 'Welcome back' popup disappear after presssing Escape key.",
                        this.reportTestObj);
            } else {
                result = Constants.FAIL
                        + ": 'Welcome back' popup does not disappear from UI after pressing Escape key.";
                logResultInReport(this.result,
                        "Verify 'Welcome back' popup disappear after presssing Escape key.",
                        this.reportTestObj);
            }

        } catch (Exception e) {
            APP_LOG.debug(" Func:pressEscapeKey = " + e);
        }

    }

    /**
     * @author pankaj.sarjal
     * @param element
     * @param colorValueHexadecimalFormat
     * @param stepDesc
     * @description To verify background-color of an element
     */
    public void verifyBackgourndColor(String element,
            String colorValueHexadecimalFormat, String stepDesc) {
        Map<String, String> dataMap = new HashMap<String, String>();
        dataMap.put(ACTION_TO_PERFORM,
                ACTION_VERIFY_COLOR_BACKGROUND_HEX_FORMAT);
        dataMap.put(ELEMENT_LOCATOR, element);
        dataMap.put(ELEMENT_INPUT_VALUE, colorValueHexadecimalFormat);
        this.result = this.performAction.execute(dataMap);
        logResultInReport(this.result, stepDesc, this.reportTestObj);

    }

    /**
     * @author mayank.mittal
     * @date 26 Mar,2018
     * @description verify Ascending/Descending order of list.
     * @return GLPInstructor_InstructorDashboardPage
     */
    public GLPInstructor_InstructorDashboardPage
           verifyUserNameOrder(String locator, String order) {
        APP_LOG.debug("Order of Name displayed in Student List");
        FindElement element = new FindElement();
        List<WebElement> listValues = element.getElements(locator);
        List<String> names = new ArrayList<String>();
        for (WebElement option : listValues) {
            names.add(option.getText().toLowerCase());
        }

        if (order.equalsIgnoreCase("asc")) {
            Collections.sort(names);
            for (String opt1 : names) {
                System.out.println(opt1.toLowerCase());
            }
        } else {
            Collections.sort(names);
            Collections.reverse(names);
        }

        int i = 0;
        for (String string : names) {

            if (string.equalsIgnoreCase(listValues.get(i).getText())) {
                APP_LOG.debug("List is sorted in the desired order.");
            } else {
                logResultInReport(Constants.FAIL, "List is not sorted",
                        reportTestObj);
            }
            i++;
        }

        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOGS);
    }

    public String verifyTextContains(String element, String text,
            String stepDesc) {
        this.APP_LOG.debug("Verify text message " + text);
        this.performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, element);
        this.result = this.performAction.execute(ACTION_VERIFY_TEXT_CONTAINS,
                element, text);
        if (result.contains("PASS")) {
            result = "PASS: " + element + " contains the correct text i.e. "
                    + text;
            logResultInReport(this.result, stepDesc, this.reportTestObj);
        } else {
            result = "FAIL: " + element
                    + " does not contains the correct text i.e. " + text;
            logResultInReport(this.result, stepDesc, this.reportTestObj);
        }
        return this.result;
    }

    public void verifyAllTextInInstructorPopup(String instructorName) {
        try {
            verifyTextContains("InstructorDashBoardUnlockPopupHeader",
                    ResourceConfigurations.getProperty(
                            "InstructorDashBoardUnlockPopupHeader"),
                    "Verify InstructorDashBoardUnlockPopupHeader text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyTextContains("InstructorDashBoardUnlockPopupHeader",
                    instructorName,
                    "Verify InstructorDashBoardUnlockPopupHeader text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("InstructorDashBoardUnlockPopupBody",
                    ResourceConfigurations
                            .getProperty("InstructorDashBoardUnlockPopupBody"),
                    "Verify InstructorDashBoardUnlockPopupBody text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("InstructorDashBoardUnlockNowButton",
                    ResourceConfigurations
                            .getProperty("InstructorDashBoardUnlockNowButton"),
                    "Verify InstructorDashBoardUnlockNowButton Button text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("InstructorDashBoardUnlockLaterButton",
                    ResourceConfigurations.getProperty(
                            "InstructorDashBoardUnlockLaterButton"),
                    "Verify InstructorDashBoardUnlockLaterButton Button text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
    }

    public void navigateToUnlockPreAssessmentPopUp() {
        try {
            clickOnElement("InstructorDashBoardUnlockLaterButton",
                    "Click on Unlock Later button");
            clickOnElement("InstructorDashBoardPerformanceStudentList",
                    "Click on Student List Tab");
            ((JavascriptExecutor) returnDriver()).executeScript(
                    "arguments[0].click();",
                    webDriver.findElement(By.cssSelector("#selectAll")));
            clickOnElement("StudentUnlockButton",
                    "Click on unlock button at student level");
            clickOnElement("FilterUnlockButton",
                    "Click on unlock button at filter level");
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
    }

    public void verifyPreAssessmentPopUp(String learnerUserName,
            boolean unlock) {
        try {
            JavascriptExecutor js = (JavascriptExecutor) returnDriver();
            js.executeScript("arguments[0].scrollIntoView(true)",
                    returnDriver().findElement(
                            By.cssSelector(".modalCancel.pe-btn--btn_large")));
            js.executeScript("scroll(" + 0 + "," + 4000 + ")");
            if (unlock) {
                verifyText("UnlockPreAssessmentTest",
                        ResourceConfigurations
                                .getProperty("UnlockPreAssessmentTest"),
                        "Verify UnlockPreAssessmentTest text is displayed in"
                                + ResourceConfigurations
                                        .getProperty("language"));
                verifyText("UnlockPreAssessmentUnlock0now",
                        ResourceConfigurations
                                .getProperty("UnlockPreAssessmentUnlock0now"),
                        "Verify UnlockPreAssessmentUnlock0now text is displayed in"
                                + ResourceConfigurations
                                        .getProperty("language"));
            } else {
                verifyText("UnlockPreAssessmentTest",
                        ResourceConfigurations
                                .getProperty("LockPreAssessmentTest"),
                        "Verify LockPreAssessmentTest text is displayed in"
                                + ResourceConfigurations
                                        .getProperty("language"));
                verifyText("UnlockPreAssessmentUnlock0now",
                        ResourceConfigurations
                                .getProperty("LockPreAssessmentUnlock0now"),
                        "Verify LockPreAssessmentUnlock0now text is displayed in"
                                + ResourceConfigurations
                                        .getProperty("language"));
            }
            verifyText("UnlockPreAssessmentBody",
                    ResourceConfigurations
                            .getProperty("UnlockPreAssessmentBody"),
                    "Verify UnlockPreAssessmentBody text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("UnlockPreAssessmentName",
                    ResourceConfigurations
                            .getProperty("UnlockPreAssessmentName"),
                    "Verify UnlockPreAssessmentName text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("UnlockPreAssessmentTests",
                    ResourceConfigurations
                            .getProperty("UnlockPreAssessmentTests"),
                    "Verify UnlockPreAssessmentTests text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("UnlockPreAssessmentLastlogin",
                    ResourceConfigurations
                            .getProperty("UnlockPreAssessmentLastlogin"),
                    "Verify UnlockPreAssessmentLastlogin text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("UnlockPreAssessmentGLPLearner",
                    ResourceConfigurations
                            .getProperty("UnlockPreAssessmentGLPLearner") + " "
                            + learnerUserName,
                    "Verify UnlockPreAssessmentGLPLearner text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("UnlockPreAssessmentPreassessment",
                    ResourceConfigurations
                            .getProperty("UnlockPreAssessmentPreassessment"),
                    "Verify UnlockPreAssessmentPreassessment text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
            verifyText("UnlockPreAssessmentCancel",
                    ResourceConfigurations
                            .getProperty("UnlockPreAssessmentCancel"),
                    "Verify UnlockPreAssessmentCancel text is displayed in"
                            + ResourceConfigurations.getProperty("language"));
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
    }

    public void navigateToLockPreAssessmentPopUp() {
        try {
            clickOnElement("UnlockPreAssessmentCancel",
                    "Click on cancel Button");
            ((JavascriptExecutor) returnDriver()).executeScript(
                    "arguments[0].click();",
                    webDriver.findElement(By.cssSelector("#selectAll")));
            ((JavascriptExecutor) returnDriver()).executeScript(
                    "arguments[0].click();",
                    webDriver.findElement(By.cssSelector("#selectAll")));
            clickOnElement("FilterLockButton", "Click on Filter Lock Button");
        } catch (Exception e) {
            APP_LOG.error(e.getMessage());
        }
    }

    /**
     * @author pankaj.sarjal
     * @param argsList
     * @return
     * @description : Press 'Escape' key
     */
    public String pressEscapeKey() {
        APP_LOG.debug("Func:pressEscapeKey");
        WebDriver webDriver = returnDriver();

        try {
            Actions action = new Actions(webDriver);
            action.sendKeys(Keys.ESCAPE).perform();

        } catch (Exception e) {
            APP_LOG.debug(" Func:pressEscapeKey = " + e);
            return Constants.FAIL + " : " + e;
        }
        return Constants.PASS;

    }

    /**
     * @author pankaj.sarjal
     * @param element
     * @description Method to scroll to particular element
     */
    public void scrollToElement(String element) {
        performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, element);
        performAction.execute(ACTION_SCROLL_INTO_VIEW, element);
    }

    /**
     * @author mukul.sehra
     * @date 20 Dec,2017
     * @description Check whether button is disabled or not
     * @param locator
     * @return true/false
     */
    public boolean isButtonDisabled(String locator) {
        String classAttributeValue = this.performAction
                .execute(ACTION_GET_ATTRIBUTE, locator, "class");

        if (classAttributeValue.contains("disabled")) {
            return true;
        } else {
            return false;
        }
    }

    /**
     * @author mayank.mittal
     * @date 10 May, 2017
     * @description To verify button is disabled or enabled
     */
    public boolean verifyButtonEnabledOrDisabled(String locator, String value) {
        String classAttributeValue = this.performAction
                .execute(ACTION_GET_ATTRIBUTE, locator, "class");

        if (classAttributeValue.contains(value)) {
            return true;
        } else {
            return false;
        }
    }

    /**
     * @author mukul.sehra
     * @date 13 Apr,2018
     * @description Clicks a checkbox corresponding to desired learner's name
     * @param learnerName
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public GLPInstructor_InstructorDashboardPage
           clickCheckboxCorrespondingToLearner(String learnerName) {
        try {
            APP_LOG.info("Inside clickCheckbox Method...");
            // Search for a learner by entering the learner name in filter and
            // hit ENTER key
            enterValueInFilterBox(learnerName + "\uE007");
            FindElement element = new FindElement();
            List<WebElement> studentListFullName = element
                    .getElements("InstructorDashBoardPerformanceFullName");
            List<WebElement> studentListCheckbox = element
                    .getElements("StudentListCheckbox");
            for (int nameCounter = 0; nameCounter < studentListFullName
                    .size(); nameCounter++) {
                if ((studentListFullName.get(nameCounter).getText())
                        .contains(learnerName)) {
                    studentListCheckbox.get(nameCounter).click();
                    break;
                }
            }
        } catch (Exception e) {
            APP_LOG.info("Exception while clicking learner specific checkbox : "
                    + e);
            logResultInReport(
                    Constants.FAIL
                            + " : Exception while clicking checkbox corresponding to learner : "
                            + e.getMessage(),
                    "Verify that the checkbox corresponding to learner '"
                            + learnerName + "' has been clicked",
                    reportTestObj);
        }
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author mukul.sehra
     * @date 13 Apr,2018
     * @description Clicks the username from the student list to navigate to
     *              profile page
     * @param learnerName
     * @return The object of GLPInstructor_StudentPerformanceDetailsPage
     */
    public GLPInstructor_StudentPerformanceDetailsPage
           navigateToLearnerProfile(String learnerName) {
        try {
            FindElement element = new FindElement();
            List<WebElement> studentListFullName = element
                    .getElements("InstructorDashBoardPerformanceFullName");
            for (int nameCounter = 0; nameCounter < studentListFullName
                    .size(); nameCounter++) {
                if ((studentListFullName.get(nameCounter).getText())
                        .contains(learnerName)) {
                    studentListFullName.get(nameCounter).click();
                    break;
                }
            }
        } catch (Exception e) {
            APP_LOG.info(
                    "Exception while navigating to the student details page : "
                            + e);
            logResultInReport(
                    Constants.FAIL
                            + " : Exception while navigating to learner : "
                            + e.getMessage(),
                    "Verify navigation to learner '" + learnerName
                            + "' details page",
                    reportTestObj);
        }
        return new GLPInstructor_StudentPerformanceDetailsPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author mayank.mittal
     * @date 16 April,2018
     * @description Enter input value in text box
     * @return The object of GLPInstructor_InstructorDashboardPage
     */

    public GLPInstructor_InstructorDashboardPage enterInputData(String locator,
            String value, String message) {
        APP_LOG.debug("Enter the input value- " + value);
        this.performAction.execute(ACTION_WAIT_FOR_ELEMENT_IS_VISIBLE, locator);
        this.result = this.performAction.execute(ACTION_TYPE_AFTER_CLEAR,
                locator, value);
        logResultInReport(this.result, message, this.reportTestObj);
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author mayank.mittal
     * @date 16 April,2018
     * @description Enter text value in filter box
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public GLPInstructor_InstructorDashboardPage
           enterValueInFilterBox(String value) {
        APP_LOG.debug("Enter the input value- " + value);
        enterInputData("PerforManceDashBoardStudentFilterBox", value,
                "enter value in the filter box.");
        return new GLPInstructor_InstructorDashboardPage(reportTestObj,
                APP_LOG);
    }

    /**
     * @author mayank.mittal
     * @date 16 April,2018
     * @description Click using keys.Enter and check the values coming in list
     *              as per filter applied.
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public void pressEnterforFilterAndVerifyResult(String value) {
        APP_LOG.debug("pressEnterforFilterAndVerifyResult");

        try {
            Actions action = new Actions(returnDriver());
            action.sendKeys(Keys.CLEAR).perform();
            action.sendKeys(Keys.ENTER).perform();
            if (performAction
                    .execute(ACTION_VERIFY_ELEMENT_PRESENT,
                            "InstructorDashBoardPerformanceNoRecordFound")
                    .contains(Constants.PASS)) {
                result = Constants.PASS
                        + "No result is found as per the value entered in filter.";
                logResultInReport(this.result,
                        "No result is found as per the value entered in filter.",
                        this.reportTestObj);
            } else {
                int count = getListCount(
                        "PerforManceDashBoardStudentStatusColumn");
                for (int rowNum = 0; rowNum < count; rowNum++) {
                    FindElement element = new FindElement();
                    List<WebElement> listValues = element.getElements(
                            "InstructorDashBoardPerformanceFullName");
                    String value1 = listValues.get(rowNum).getText();
                    if (value1.contains(value))
                        result = Constants.PASS + value
                                + " :Value is present in list row: " + rowNum;
                    else
                        result = Constants.FAIL + value
                                + " :Value is not present in list row: "
                                + rowNum;
                }
                logResultInReport(this.result,
                        "Verify values present in filter are present ",
                        this.reportTestObj);
            }
        } catch (Exception e) {
            APP_LOG.debug("Func:pressEscapeKey = " + e);
        }

    }

    /**
     * @author mayank.mittal
     * @date 16 April,2018
     * @description verify student list row count when filter value is removed.
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public void verifyListCount(int originalListCount) {
        APP_LOG.debug("verifyListCount");
        try {
            Actions action = new Actions(returnDriver());
            action.sendKeys(Keys.ENTER).perform();
            int actualListCount = getListCount(
                    "PerforManceDashBoardStudentStatusColumn");
            if (originalListCount == actualListCount) {
                result = Constants.PASS + "List count values remains same.";
            } else {
                result = Constants.FAIL + "List count values is changed.";
            }
        } catch (Exception exception) {
            APP_LOG.debug("verifyListCount" + exception);
        }
    }

    /**
     * @author mayank.mittal
     * @date 19 April,2018
     * @description verify pagination is present.
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public void verifyPaginationPresent() {
        APP_LOG.debug("verifyPaginationPresent");
        try {
            if (getListCount("PerforManceDashBoardStudentStatusColumn") >= 15) {
                verifyElementPresent(
                        "PerforManceDashBoardStudentListPagination",
                        "Pagination is present.");
                verifyElementPresent(
                        "PerforManceDashBoardStudentListPaginationPrevious",
                        "Pagination Previous button is present.");
                verifyElementPresent(
                        "PerforManceDashBoardStudentListPaginationNext",
                        "Pagination Next button is present.");
                result = Constants.PASS + "Pagination is present.";
            } else {
                result = Constants.FAIL + "Pagination is not present.";
            }
        } catch (Exception exception) {
            APP_LOG.debug("verifyListCount" + exception);
        }
        logResultInReport(this.result, "Pagination is present.",
                this.reportTestObj);
    }

    /**
     * @author mayank.mittal
     * @date 19 April,2018
     * @description verify pagination Next button is disabled.
     * @return The object of GLPInstructor_InstructorDashboardPage
     */
    public void verifyPaginationNextButtonIsDisabled() {
        APP_LOG.debug("verifyPaginationNextButtonIsDisabled");
        try {
            for (int count = 0; count < 15; count++) {
                if (verifyButtonEnabledOrDisabled(
                        "PerforManceDashBoardStudentListPaginationNext",
                        "enabled"))
                    clickOnElement(
                            "PerforManceDashBoardStudentListPaginationNext",
                            "Click on Next Pagination Button.");
                else
                    break;
            }
        } catch (Exception exception) {
            APP_LOG.debug("verifyListCount" + exception);
        }
        result = Constants.PASS + "Pagination Next button is disabled.";
        logResultInReport(this.result, "Pagination Next button is disabled.",
                this.reportTestObj);
    }
}